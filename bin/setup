#!/usr/bin/env php
<?php
// Set permissions
chmod(__DIR__ . '/../storage/cache', 0777);
chmod(__DIR__ . '/../storage/logs', 0777);
chmod(__DIR__ . '/../storage/sessions', 0777);
chmod(__DIR__ . '/../storage/uploads', 0777);

// Set Crypto config default secret value
$contents = file_get_contents(__DIR__ . '/../config/crypto.php');
$contents = strtr($contents, [
    "'secret'" => "sodium_base642bin('" . sodium_bin2base64(
            sodium_crypto_secretbox_keygen(),
            SODIUM_BASE64_VARIANT_ORIGINAL
        ) . "', SODIUM_BASE64_VARIANT_ORIGINAL)",
]);
file_put_contents(__DIR__ . '/../config/crypto.php', $contents);
